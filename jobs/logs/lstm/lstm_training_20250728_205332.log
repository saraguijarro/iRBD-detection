2025-07-28 20:53:32,952 - INFO - LSTM Training Pipeline initialized successfully
2025-07-28 20:53:32,952 - INFO - Project directory: /work3/s184484/iRBD-detection
2025-07-28 20:53:32,953 - INFO - Device: cpu
2025-07-28 20:53:32,953 - INFO - Model architecture: 2-layer bidirectional LSTM with attention
2025-07-28 20:53:32,953 - INFO - ================================================================================
2025-07-28 20:53:32,954 - INFO - STARTING LSTM TRAINING PIPELINE FOR iRBD DETECTION
2025-07-28 20:53:32,954 - INFO - ================================================================================
2025-07-28 20:53:32,954 - INFO - Loading participant data...
2025-07-28 20:53:32,955 - INFO - Found 10 control participant files
2025-07-28 20:53:34,872 - INFO - Found 10 iRBD participant files
2025-07-28 20:53:35,135 - INFO - Loaded iRBD AXRBD004: (31, 2880, 1024)
2025-07-28 20:53:35,407 - INFO - Loaded iRBD AXRBD021: (30, 2880, 1024)
2025-07-28 20:53:35,699 - INFO - Loaded iRBD AXRBD095: (34, 2880, 1024)
2025-07-28 20:53:35,972 - INFO - Loaded iRBD AXRBD020: (30, 2880, 1024)
2025-07-28 20:53:36,258 - INFO - Loaded iRBD AXRBD071: (33, 2880, 1024)
2025-07-28 20:53:36,607 - INFO - Loaded iRBD AXRBD007: (37, 2880, 1024)
2025-07-28 20:53:36,991 - INFO - Loaded iRBD AXRBD032: (40, 2880, 1024)
2025-07-28 20:53:37,326 - INFO - Loaded iRBD AXRBD030: (34, 2880, 1024)
2025-07-28 20:53:37,678 - INFO - Loaded iRBD AXRBD013: (36, 2880, 1024)
2025-07-28 20:53:37,681 - ERROR - Error loading iRBD file /work3/s184484/iRBD-detection/data/features/irbd/AXRBD059_features.npy: 
2025-07-28 20:53:37,681 - INFO - Successfully loaded 19 participants:
2025-07-28 20:53:37,681 - INFO -   - Controls: 10
2025-07-28 20:53:37,681 - INFO -   - iRBD: 9
2025-07-28 20:53:37,682 - INFO - Starting 5-fold cross-validation...
2025-07-28 20:53:37,683 - INFO - 
============================================================
2025-07-28 20:53:37,683 - INFO - CROSS-VALIDATION FOLD 1/5
2025-07-28 20:53:37,684 - INFO - ============================================================
2025-07-28 20:53:37,685 - INFO - Fold 1 participants:
2025-07-28 20:53:37,685 - INFO -   Train: 12 participants
2025-07-28 20:53:37,686 - INFO -   Validation: 3 participants
2025-07-28 20:53:37,686 - INFO -   Test: 4 participants
2025-07-28 20:53:37,688 - INFO - Starting model training (Fold 1)...
2025-07-28 20:53:37,688 - INFO - Initial memory usage: 11912.84 MB
2025-07-28 20:53:37,702 - INFO - Class weights: Control=0.950, iRBD=1.056
2025-07-28 20:53:40,193 - ERROR - Error in train_model: [enforce fail at alloc_cpu.cpp:119] err == 0. DefaultCPUAllocator: can't allocate memory: you tried to allocate 389283840 bytes. Error code 12 (Cannot allocate memory)
2025-07-28 20:53:40,194 - ERROR - Training failed for fold 1
2025-07-28 20:53:40,194 - INFO - 
============================================================
2025-07-28 20:53:40,195 - INFO - CROSS-VALIDATION FOLD 2/5
2025-07-28 20:53:40,195 - INFO - ============================================================
2025-07-28 20:53:40,196 - INFO - Fold 2 participants:
2025-07-28 20:53:40,197 - INFO -   Train: 12 participants
2025-07-28 20:53:40,197 - INFO -   Validation: 3 participants
2025-07-28 20:53:40,197 - INFO -   Test: 4 participants
2025-07-28 20:53:40,198 - INFO - Starting model training (Fold 2)...
2025-07-28 20:53:40,198 - INFO - Initial memory usage: 11991.05 MB
2025-07-28 20:53:40,210 - INFO - Class weights: Control=0.950, iRBD=1.056
2025-07-28 20:53:40,211 - ERROR - Error in train_model: [enforce fail at alloc_cpu.cpp:119] err == 0. DefaultCPUAllocator: can't allocate memory: you tried to allocate 365690880 bytes. Error code 12 (Cannot allocate memory)
2025-07-28 20:53:40,211 - ERROR - Training failed for fold 2
2025-07-28 20:53:40,212 - INFO - 
============================================================
2025-07-28 20:53:40,212 - INFO - CROSS-VALIDATION FOLD 3/5
2025-07-28 20:53:40,212 - INFO - ============================================================
2025-07-28 20:53:40,213 - INFO - Fold 3 participants:
2025-07-28 20:53:40,214 - INFO -   Train: 12 participants
2025-07-28 20:53:40,214 - INFO -   Validation: 3 participants
2025-07-28 20:53:40,214 - INFO -   Test: 4 participants
2025-07-28 20:53:40,215 - INFO - Starting model training (Fold 3)...
2025-07-28 20:53:40,215 - INFO - Initial memory usage: 11991.05 MB
2025-07-28 20:53:40,228 - INFO - Class weights: Control=0.950, iRBD=1.056
2025-07-28 20:53:40,229 - ERROR - Error in train_model: [enforce fail at alloc_cpu.cpp:119] err == 0. DefaultCPUAllocator: can't allocate memory: you tried to allocate 353894400 bytes. Error code 12 (Cannot allocate memory)
2025-07-28 20:53:40,229 - ERROR - Training failed for fold 3
2025-07-28 20:53:40,230 - INFO - 
============================================================
2025-07-28 20:53:40,230 - INFO - CROSS-VALIDATION FOLD 4/5
2025-07-28 20:53:40,230 - INFO - ============================================================
2025-07-28 20:53:40,231 - INFO - Fold 4 participants:
2025-07-28 20:53:40,232 - INFO -   Train: 12 participants
2025-07-28 20:53:40,232 - INFO -   Validation: 3 participants
2025-07-28 20:53:40,232 - INFO -   Test: 4 participants
2025-07-28 20:53:40,233 - INFO - Starting model training (Fold 4)...
2025-07-28 20:53:40,233 - INFO - Initial memory usage: 11991.05 MB
2025-07-28 20:53:40,244 - INFO - Class weights: Control=0.950, iRBD=1.056
2025-07-28 20:53:40,245 - ERROR - Error in train_model: [enforce fail at alloc_cpu.cpp:119] err == 0. DefaultCPUAllocator: can't allocate memory: you tried to allocate 365690880 bytes. Error code 12 (Cannot allocate memory)
2025-07-28 20:53:40,245 - ERROR - Training failed for fold 4
2025-07-28 20:53:40,245 - INFO - 
============================================================
2025-07-28 20:53:40,246 - INFO - CROSS-VALIDATION FOLD 5/5
2025-07-28 20:53:40,246 - INFO - ============================================================
2025-07-28 20:53:40,247 - INFO - Fold 5 participants:
2025-07-28 20:53:40,247 - INFO -   Train: 12 participants
2025-07-28 20:53:40,247 - INFO -   Validation: 4 participants
2025-07-28 20:53:40,248 - INFO -   Test: 3 participants
2025-07-28 20:53:40,248 - INFO - Starting model training (Fold 5)...
2025-07-28 20:53:40,248 - INFO - Initial memory usage: 11991.05 MB
2025-07-28 20:53:40,259 - INFO - Class weights: Control=0.950, iRBD=1.056
2025-07-28 20:53:40,260 - ERROR - Error in train_model: [enforce fail at alloc_cpu.cpp:119] err == 0. DefaultCPUAllocator: can't allocate memory: you tried to allocate 401080320 bytes. Error code 12 (Cannot allocate memory)
2025-07-28 20:53:40,261 - ERROR - Training failed for fold 5
2025-07-28 20:53:40,261 - ERROR - Cross-validation failed
