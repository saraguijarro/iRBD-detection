2025-07-28 09:21:36,433 - INFO - LSTM Training Pipeline initialized successfully
2025-07-28 09:21:36,433 - INFO - Project directory: /work3/s184484/iRBD-detection
2025-07-28 09:21:36,433 - INFO - Device: cpu
2025-07-28 09:21:36,434 - INFO - Model architecture: 2-layer bidirectional LSTM with attention
2025-07-28 09:21:36,434 - INFO - ================================================================================
2025-07-28 09:21:36,434 - INFO - STARTING LSTM TRAINING PIPELINE FOR iRBD DETECTION
2025-07-28 09:21:36,435 - INFO - ================================================================================
2025-07-28 09:21:36,435 - INFO - Loading participant data...
2025-07-28 09:21:36,438 - INFO - Found 5 control participant files
2025-07-28 09:21:37,036 - INFO - Found 5 iRBD participant files
2025-07-28 09:21:37,280 - INFO - Loaded iRBD AXRBD004: (31, 2880, 1024)
2025-07-28 09:21:37,532 - INFO - Loaded iRBD AXRBD021: (30, 2880, 1024)
2025-07-28 09:21:37,795 - INFO - Loaded iRBD AXRBD095: (34, 2880, 1024)
2025-07-28 09:21:38,048 - INFO - Loaded iRBD AXRBD020: (30, 2880, 1024)
2025-07-28 09:21:38,306 - INFO - Loaded iRBD AXRBD071: (33, 2880, 1024)
2025-07-28 09:21:38,307 - INFO - Successfully loaded 10 participants:
2025-07-28 09:21:38,307 - INFO -   - Controls: 5
2025-07-28 09:21:38,307 - INFO -   - iRBD: 5
2025-07-28 09:21:38,307 - INFO - Starting 5-fold cross-validation...
2025-07-28 09:21:38,309 - INFO - 
============================================================
2025-07-28 09:21:38,309 - INFO - CROSS-VALIDATION FOLD 1/5
2025-07-28 09:21:38,310 - INFO - ============================================================
2025-07-28 09:21:38,311 - INFO - Fold 1 participants:
2025-07-28 09:21:38,311 - INFO -   Train: 6 participants
2025-07-28 09:21:38,312 - INFO -   Validation: 2 participants
2025-07-28 09:21:38,312 - INFO -   Test: 2 participants
2025-07-28 09:21:38,313 - INFO - Starting model training (Fold 1)...
2025-07-28 09:21:38,313 - INFO - Initial memory usage: 5522.50 MB
2025-07-28 09:21:38,328 - INFO - Class weights: Control=1.000, iRBD=1.000
2025-07-28 09:21:50,124 - INFO - Epoch   0: Train Loss=2.0352, Val Loss=0.6414, Train Acc=0.611, Val Acc=1.000
2025-07-28 09:21:59,311 - INFO - Epoch   1: Train Loss=1.9733, Val Loss=0.5176, Train Acc=0.556, Val Acc=1.000
2025-07-28 09:22:08,523 - INFO - Epoch   2: Train Loss=1.6414, Val Loss=0.2541, Train Acc=0.722, Val Acc=1.000
2025-07-28 09:22:17,588 - INFO - Epoch   3: Train Loss=1.1431, Val Loss=0.4374, Train Acc=0.889, Val Acc=0.500
2025-07-28 09:22:26,509 - INFO - Epoch   4: Train Loss=0.8705, Val Loss=0.0182, Train Acc=0.889, Val Acc=1.000
2025-07-28 09:23:22,196 - INFO - Epoch  10: Train Loss=0.2330, Val Loss=0.0009, Train Acc=0.944, Val Acc=1.000
2025-07-28 09:24:53,526 - INFO - Epoch  20: Train Loss=1.2905, Val Loss=0.0004, Train Acc=0.889, Val Acc=1.000
2025-07-28 09:26:23,860 - INFO - Epoch  30: Train Loss=0.0158, Val Loss=0.0002, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:27:57,170 - INFO - Epoch  40: Train Loss=0.0004, Val Loss=0.0001, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:29:29,263 - INFO - Epoch  50: Train Loss=0.0004, Val Loss=0.0001, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:31:00,980 - INFO - Epoch  60: Train Loss=0.0003, Val Loss=0.0001, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:32:30,282 - INFO - Epoch  70: Train Loss=0.0002, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:34:01,449 - INFO - Epoch  80: Train Loss=0.0001, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:35:32,983 - INFO - Epoch  90: Train Loss=0.0002, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:36:56,022 - INFO - 
Fold 1 Test Results:
2025-07-28 09:36:56,023 - INFO -   Accuracy: 1.000
2025-07-28 09:36:56,023 - INFO -   Precision: 1.000
2025-07-28 09:36:56,023 - INFO -   Recall: 1.000
2025-07-28 09:36:56,024 - INFO -   F1-Score: 1.000
2025-07-28 09:36:56,024 - INFO -   Sensitivity: 1.000
2025-07-28 09:36:56,025 - INFO -   Specificity: 1.000
2025-07-28 09:36:56,025 - INFO -   AUC-ROC: 1.000
2025-07-28 09:36:56,025 - INFO -   AUC-PR: 1.000
2025-07-28 09:36:56,029 - INFO - 
============================================================
2025-07-28 09:36:56,029 - INFO - CROSS-VALIDATION FOLD 2/5
2025-07-28 09:36:56,030 - INFO - ============================================================
2025-07-28 09:36:56,031 - INFO - Fold 2 participants:
2025-07-28 09:36:56,031 - INFO -   Train: 6 participants
2025-07-28 09:36:56,032 - INFO -   Validation: 2 participants
2025-07-28 09:36:56,032 - INFO -   Test: 2 participants
2025-07-28 09:36:56,032 - INFO - Starting model training (Fold 2)...
2025-07-28 09:36:56,033 - INFO - Initial memory usage: 5667.66 MB
2025-07-28 09:36:56,044 - INFO - Class weights: Control=1.000, iRBD=1.000
2025-07-28 09:37:04,956 - INFO - Epoch   0: Train Loss=2.1723, Val Loss=0.7096, Train Acc=0.444, Val Acc=0.500
2025-07-28 09:37:14,782 - INFO - Epoch   1: Train Loss=1.8949, Val Loss=0.7632, Train Acc=0.778, Val Acc=0.500
2025-07-28 09:37:24,194 - INFO - Epoch   2: Train Loss=1.5621, Val Loss=1.0838, Train Acc=0.722, Val Acc=0.000
2025-07-28 09:37:33,824 - INFO - Epoch   3: Train Loss=0.9484, Val Loss=1.9370, Train Acc=0.889, Val Acc=0.000
2025-07-28 09:37:43,742 - INFO - Epoch   4: Train Loss=1.5082, Val Loss=1.5162, Train Acc=0.778, Val Acc=0.500
2025-07-28 09:38:40,050 - INFO - Epoch  10: Train Loss=0.0624, Val Loss=2.7020, Train Acc=1.000, Val Acc=0.500
2025-07-28 09:39:27,133 - INFO - Early stopping at epoch 15
2025-07-28 09:39:27,802 - INFO - 
Fold 2 Test Results:
2025-07-28 09:39:27,803 - INFO -   Accuracy: 0.500
2025-07-28 09:39:27,803 - INFO -   Precision: 0.250
2025-07-28 09:39:27,803 - INFO -   Recall: 0.500
2025-07-28 09:39:27,803 - INFO -   F1-Score: 0.333
2025-07-28 09:39:27,804 - INFO -   Sensitivity: 0.000
2025-07-28 09:39:27,804 - INFO -   Specificity: 1.000
2025-07-28 09:39:27,804 - INFO -   AUC-ROC: 1.000
2025-07-28 09:39:27,804 - INFO -   AUC-PR: 1.000
2025-07-28 09:39:27,808 - INFO - 
============================================================
2025-07-28 09:39:27,808 - INFO - CROSS-VALIDATION FOLD 3/5
2025-07-28 09:39:27,808 - INFO - ============================================================
2025-07-28 09:39:27,809 - INFO - Fold 3 participants:
2025-07-28 09:39:27,810 - INFO -   Train: 6 participants
2025-07-28 09:39:27,810 - INFO -   Validation: 2 participants
2025-07-28 09:39:27,810 - INFO -   Test: 2 participants
2025-07-28 09:39:27,811 - INFO - Starting model training (Fold 3)...
2025-07-28 09:39:27,811 - INFO - Initial memory usage: 5680.84 MB
2025-07-28 09:39:27,822 - INFO - Class weights: Control=1.000, iRBD=1.000
2025-07-28 09:39:36,886 - INFO - Epoch   0: Train Loss=2.0034, Val Loss=0.6660, Train Acc=0.722, Val Acc=0.500
2025-07-28 09:39:46,140 - INFO - Epoch   1: Train Loss=1.8962, Val Loss=0.6099, Train Acc=0.556, Val Acc=1.000
2025-07-28 09:39:54,976 - INFO - Epoch   2: Train Loss=1.8415, Val Loss=0.5338, Train Acc=0.611, Val Acc=1.000
2025-07-28 09:40:03,500 - INFO - Epoch   3: Train Loss=1.4087, Val Loss=0.3064, Train Acc=0.833, Val Acc=1.000
2025-07-28 09:40:12,336 - INFO - Epoch   4: Train Loss=1.1025, Val Loss=0.2073, Train Acc=0.889, Val Acc=1.000
2025-07-28 09:41:05,712 - INFO - Epoch  10: Train Loss=0.1954, Val Loss=0.0003, Train Acc=0.944, Val Acc=1.000
2025-07-28 09:42:35,115 - INFO - Epoch  20: Train Loss=0.0016, Val Loss=0.0001, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:44:03,843 - INFO - Epoch  30: Train Loss=0.0005, Val Loss=0.0001, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:45:32,656 - INFO - Epoch  40: Train Loss=0.0003, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:47:02,482 - INFO - Epoch  50: Train Loss=0.0002, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:48:32,533 - INFO - Epoch  60: Train Loss=0.0001, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:50:03,363 - INFO - Epoch  70: Train Loss=0.0001, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:51:32,836 - INFO - Epoch  80: Train Loss=0.0002, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:53:02,788 - INFO - Epoch  90: Train Loss=0.0002, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:54:24,750 - INFO - 
Fold 3 Test Results:
2025-07-28 09:54:24,751 - INFO -   Accuracy: 1.000
2025-07-28 09:54:24,751 - INFO -   Precision: 1.000
2025-07-28 09:54:24,752 - INFO -   Recall: 1.000
2025-07-28 09:54:24,752 - INFO -   F1-Score: 1.000
2025-07-28 09:54:24,752 - INFO -   Sensitivity: 1.000
2025-07-28 09:54:24,753 - INFO -   Specificity: 1.000
2025-07-28 09:54:24,753 - INFO -   AUC-ROC: 1.000
2025-07-28 09:54:24,753 - INFO -   AUC-PR: 1.000
2025-07-28 09:54:24,757 - INFO - 
============================================================
2025-07-28 09:54:24,758 - INFO - CROSS-VALIDATION FOLD 4/5
2025-07-28 09:54:24,758 - INFO - ============================================================
2025-07-28 09:54:24,759 - INFO - Fold 4 participants:
2025-07-28 09:54:24,760 - INFO -   Train: 6 participants
2025-07-28 09:54:24,760 - INFO -   Validation: 2 participants
2025-07-28 09:54:24,761 - INFO -   Test: 2 participants
2025-07-28 09:54:24,762 - INFO - Starting model training (Fold 4)...
2025-07-28 09:54:24,763 - INFO - Initial memory usage: 5680.88 MB
2025-07-28 09:54:24,774 - INFO - Class weights: Control=1.000, iRBD=1.000
2025-07-28 09:54:34,351 - INFO - Epoch   0: Train Loss=2.2705, Val Loss=0.6728, Train Acc=0.333, Val Acc=0.500
2025-07-28 09:54:43,947 - INFO - Epoch   1: Train Loss=2.0100, Val Loss=0.6641, Train Acc=0.556, Val Acc=0.500
2025-07-28 09:54:53,740 - INFO - Epoch   2: Train Loss=1.8764, Val Loss=0.6201, Train Acc=0.722, Val Acc=0.500
2025-07-28 09:55:03,464 - INFO - Epoch   3: Train Loss=1.5100, Val Loss=0.5459, Train Acc=0.833, Val Acc=0.500
2025-07-28 09:55:13,453 - INFO - Epoch   4: Train Loss=0.8616, Val Loss=0.4685, Train Acc=1.000, Val Acc=0.500
2025-07-28 09:56:12,855 - INFO - Epoch  10: Train Loss=0.0020, Val Loss=0.0031, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:57:51,023 - INFO - Epoch  20: Train Loss=0.0006, Val Loss=0.0004, Train Acc=1.000, Val Acc=1.000
2025-07-28 09:59:29,398 - INFO - Epoch  30: Train Loss=0.0005, Val Loss=0.0003, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:01:08,240 - INFO - Epoch  40: Train Loss=0.0003, Val Loss=0.0003, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:02:45,799 - INFO - Epoch  50: Train Loss=0.0002, Val Loss=0.0003, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:04:23,782 - INFO - Epoch  60: Train Loss=0.0003, Val Loss=0.0003, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:05:32,978 - INFO - Early stopping at epoch 67
2025-07-28 10:05:33,674 - INFO - 
Fold 4 Test Results:
2025-07-28 10:05:33,675 - INFO -   Accuracy: 0.500
2025-07-28 10:05:33,676 - INFO -   Precision: 0.250
2025-07-28 10:05:33,676 - INFO -   Recall: 0.500
2025-07-28 10:05:33,676 - INFO -   F1-Score: 0.333
2025-07-28 10:05:33,677 - INFO -   Sensitivity: 0.000
2025-07-28 10:05:33,677 - INFO -   Specificity: 1.000
2025-07-28 10:05:33,677 - INFO -   AUC-ROC: 1.000
2025-07-28 10:05:33,677 - INFO -   AUC-PR: 1.000
2025-07-28 10:05:33,681 - INFO - 
============================================================
2025-07-28 10:05:33,682 - INFO - CROSS-VALIDATION FOLD 5/5
2025-07-28 10:05:33,682 - INFO - ============================================================
2025-07-28 10:05:33,684 - INFO - Fold 5 participants:
2025-07-28 10:05:33,684 - INFO -   Train: 6 participants
2025-07-28 10:05:33,685 - INFO -   Validation: 2 participants
2025-07-28 10:05:33,685 - INFO -   Test: 2 participants
2025-07-28 10:05:33,685 - INFO - Starting model training (Fold 5)...
2025-07-28 10:05:33,686 - INFO - Initial memory usage: 5681.89 MB
2025-07-28 10:05:33,697 - INFO - Class weights: Control=1.000, iRBD=1.000
2025-07-28 10:05:41,999 - INFO - Epoch   0: Train Loss=2.2446, Val Loss=0.7520, Train Acc=0.611, Val Acc=0.500
2025-07-28 10:05:50,603 - INFO - Epoch   1: Train Loss=2.0151, Val Loss=0.6593, Train Acc=0.500, Val Acc=0.500
2025-07-28 10:05:59,218 - INFO - Epoch   2: Train Loss=1.6757, Val Loss=0.5198, Train Acc=0.778, Val Acc=1.000
2025-07-28 10:06:07,838 - INFO - Epoch   3: Train Loss=1.0882, Val Loss=0.2660, Train Acc=0.889, Val Acc=1.000
2025-07-28 10:06:16,714 - INFO - Epoch   4: Train Loss=0.4319, Val Loss=0.0368, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:07:09,173 - INFO - Epoch  10: Train Loss=0.0066, Val Loss=0.0004, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:08:36,605 - INFO - Epoch  20: Train Loss=0.0006, Val Loss=0.0001, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:10:03,570 - INFO - Epoch  30: Train Loss=0.0004, Val Loss=0.0001, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:11:31,815 - INFO - Epoch  40: Train Loss=0.0004, Val Loss=0.0001, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:12:59,494 - INFO - Epoch  50: Train Loss=0.0002, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:14:28,423 - INFO - Epoch  60: Train Loss=0.0002, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:15:54,840 - INFO - Epoch  70: Train Loss=0.0002, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:17:24,178 - INFO - Epoch  80: Train Loss=0.0001, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:18:52,848 - INFO - Epoch  90: Train Loss=0.0001, Val Loss=0.0000, Train Acc=1.000, Val Acc=1.000
2025-07-28 10:20:13,684 - INFO - 
Fold 5 Test Results:
2025-07-28 10:20:13,685 - INFO -   Accuracy: 0.500
2025-07-28 10:20:13,685 - INFO -   Precision: 0.250
2025-07-28 10:20:13,685 - INFO -   Recall: 0.500
2025-07-28 10:20:13,686 - INFO -   F1-Score: 0.333
2025-07-28 10:20:13,686 - INFO -   Sensitivity: 0.000
2025-07-28 10:20:13,686 - INFO -   Specificity: 1.000
2025-07-28 10:20:13,686 - INFO -   AUC-ROC: 1.000
2025-07-28 10:20:13,687 - INFO -   AUC-PR: 1.000
2025-07-28 10:20:13,690 - INFO - 
================================================================================
2025-07-28 10:20:13,691 - INFO - CROSS-VALIDATION SUMMARY
2025-07-28 10:20:13,691 - INFO - ================================================================================
2025-07-28 10:20:13,691 - INFO - Average Test Accuracy: 0.700 ± 0.245
2025-07-28 10:20:13,692 - INFO - Average Test AUC-ROC: 1.000 ± 0.000
2025-07-28 10:20:13,699 - INFO - Results saved to: /work3/s184484/iRBD-detection/results/lstm/evaluation/cross_validation_results.json
2025-07-28 10:20:13,699 - INFO - LSTM training pipeline completed successfully!
