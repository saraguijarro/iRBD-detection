ERROR: Unable to locate a modulefile for 'miniconda3/4.12.0'
2026-01-12 22:27:19,215 - INFO - Initialized LSTM Night-Level Pipeline (version=v0)
2026-01-12 22:27:19,215 - INFO - Initialized LSTM Night-Level Pipeline (version=v0)
2026-01-12 22:27:19,216 - INFO - Device: cuda
2026-01-12 22:27:19,216 - INFO - Device: cuda
2026-01-12 22:27:19,217 - INFO - Features directory: /work3/s184484/iRBD-detection/data/features_v0
2026-01-12 22:27:19,217 - INFO - Features directory: /work3/s184484/iRBD-detection/data/features_v0
2026-01-12 22:27:19,217 - INFO - Results directory: /work3/s184484/iRBD-detection/results/lstm_v0_night_level
2026-01-12 22:27:19,217 - INFO - Results directory: /work3/s184484/iRBD-detection/results/lstm_v0_night_level
2026-01-12 22:27:19,218 - INFO - Log file: /work3/s184484/iRBD-detection/results/lstm_v0_night_level/training.log
2026-01-12 22:27:19,218 - INFO - Log file: /work3/s184484/iRBD-detection/results/lstm_v0_night_level/training.log
2026-01-12 22:27:19,219 - INFO - ======================================================================
2026-01-12 22:27:19,219 - INFO - ======================================================================
2026-01-12 22:27:19,220 - INFO - STARTING NIGHT-LEVEL LSTM TRAINING
2026-01-12 22:27:19,220 - INFO - STARTING NIGHT-LEVEL LSTM TRAINING
2026-01-12 22:27:19,221 - INFO - ======================================================================
2026-01-12 22:27:19,221 - INFO - ======================================================================
2026-01-12 22:27:19,222 - INFO - Preparing night-level dataset...
2026-01-12 22:27:19,222 - INFO - Preparing night-level dataset...
2026-01-12 22:27:19,225 - INFO - Found 42 control participants
2026-01-12 22:27:19,225 - INFO - Found 42 control participants
2026-01-12 22:27:57,284 - INFO - Found 42 iRBD participants
2026-01-12 22:27:57,284 - INFO - Found 42 iRBD participants
2026-01-12 22:28:57,452 - INFO - Night-level dataset prepared:
2026-01-12 22:28:57,452 - INFO - Night-level dataset prepared:
2026-01-12 22:28:57,454 - INFO -   Total nights: 2058
2026-01-12 22:28:57,454 - INFO -   Total nights: 2058
2026-01-12 22:28:57,458 - INFO -   Control nights: 832
2026-01-12 22:28:57,458 - INFO -   Control nights: 832
2026-01-12 22:28:57,459 - INFO -   iRBD nights: 1226
2026-01-12 22:28:57,459 - INFO -   iRBD nights: 1226
2026-01-12 22:28:57,460 - INFO -   Unique participants: 84
2026-01-12 22:28:57,460 - INFO -   Unique participants: 84
2026-01-12 22:28:57,469 - INFO - 
======================================================================
2026-01-12 22:28:57,469 - INFO - 
======================================================================
2026-01-12 22:28:57,470 - INFO - FOLD 1/5
2026-01-12 22:28:57,470 - INFO - FOLD 1/5
2026-01-12 22:28:57,471 - INFO - ======================================================================
2026-01-12 22:28:57,471 - INFO - ======================================================================
2026-01-12 22:28:57,473 - INFO - Train nights: 1643, Test nights: 415
2026-01-12 22:28:57,473 - INFO - Train nights: 1643, Test nights: 415
2026-01-12 22:28:57,475 - INFO - Train participants: 67, Test participants: 17
2026-01-12 22:28:57,475 - INFO - Train participants: 67, Test participants: 17
2026-01-12 22:31:26,320 - INFO - Epoch 5/50 - Train Loss: 0.2337, Val Loss: 0.2210
2026-01-12 22:31:26,320 - INFO - Epoch 5/50 - Train Loss: 0.2337, Val Loss: 0.2210
2026-01-12 22:33:37,850 - INFO - Epoch 10/50 - Train Loss: 0.1448, Val Loss: 0.2417
2026-01-12 22:33:37,850 - INFO - Epoch 10/50 - Train Loss: 0.1448, Val Loss: 0.2417
2026-01-12 22:35:49,220 - INFO - Epoch 15/50 - Train Loss: 0.1045, Val Loss: 0.3235
2026-01-12 22:35:49,220 - INFO - Epoch 15/50 - Train Loss: 0.1045, Val Loss: 0.3235
2026-01-12 22:37:08,043 - INFO - Early stopping at epoch 18
2026-01-12 22:37:08,043 - INFO - Early stopping at epoch 18
2026-01-12 22:37:12,032 - INFO - 
Fold 1 Results:
2026-01-12 22:37:12,032 - INFO - 
Fold 1 Results:
2026-01-12 22:37:12,033 - INFO -   Night-level:
2026-01-12 22:37:12,033 - INFO -   Night-level:
2026-01-12 22:37:12,034 - INFO -     Accuracy: 0.9277
2026-01-12 22:37:12,034 - INFO -     Accuracy: 0.9277
2026-01-12 22:37:12,034 - INFO -     ROC-AUC: 0.9863
2026-01-12 22:37:12,034 - INFO -     ROC-AUC: 0.9863
2026-01-12 22:37:12,035 - INFO -   Participant-level (CLINICAL):
2026-01-12 22:37:12,035 - INFO -   Participant-level (CLINICAL):
2026-01-12 22:37:12,035 - INFO -     Accuracy: 1.0000
2026-01-12 22:37:12,035 - INFO -     Accuracy: 1.0000
2026-01-12 22:37:12,036 - INFO -     Precision: 1.0000
2026-01-12 22:37:12,036 - INFO -     Precision: 1.0000
2026-01-12 22:37:12,037 - INFO -     Recall: 1.0000
2026-01-12 22:37:12,037 - INFO -     Recall: 1.0000
2026-01-12 22:37:12,037 - INFO -     F1: 1.0000
2026-01-12 22:37:12,037 - INFO -     F1: 1.0000
2026-01-12 22:37:12,038 - INFO -     ROC-AUC: 1.0000
2026-01-12 22:37:12,038 - INFO -     ROC-AUC: 1.0000
2026-01-12 22:37:12,038 - INFO - 
======================================================================
2026-01-12 22:37:12,038 - INFO - 
======================================================================
2026-01-12 22:37:12,039 - INFO - FOLD 2/5
2026-01-12 22:37:12,039 - INFO - FOLD 2/5
2026-01-12 22:37:12,040 - INFO - ======================================================================
2026-01-12 22:37:12,040 - INFO - ======================================================================
2026-01-12 22:37:12,041 - INFO - Train nights: 1645, Test nights: 413
2026-01-12 22:37:12,041 - INFO - Train nights: 1645, Test nights: 413
2026-01-12 22:37:12,042 - INFO - Train participants: 67, Test participants: 17
2026-01-12 22:37:12,042 - INFO - Train participants: 67, Test participants: 17
2026-01-12 22:39:23,478 - INFO - Epoch 5/50 - Train Loss: 0.1932, Val Loss: 0.3611
2026-01-12 22:39:23,478 - INFO - Epoch 5/50 - Train Loss: 0.1932, Val Loss: 0.3611
2026-01-12 22:41:34,896 - INFO - Epoch 10/50 - Train Loss: 0.1656, Val Loss: 0.4318
2026-01-12 22:41:34,896 - INFO - Epoch 10/50 - Train Loss: 0.1656, Val Loss: 0.4318
2026-01-12 22:43:46,306 - INFO - Epoch 15/50 - Train Loss: 0.0937, Val Loss: 0.5949
2026-01-12 22:43:46,306 - INFO - Epoch 15/50 - Train Loss: 0.0937, Val Loss: 0.5949
2026-01-12 22:45:57,676 - INFO - Epoch 20/50 - Train Loss: 0.0614, Val Loss: 0.5828
2026-01-12 22:45:57,676 - INFO - Epoch 20/50 - Train Loss: 0.0614, Val Loss: 0.5828
2026-01-12 22:47:42,854 - INFO - Early stopping at epoch 24
2026-01-12 22:47:42,854 - INFO - Early stopping at epoch 24
2026-01-12 22:47:46,811 - INFO - 
Fold 2 Results:
2026-01-12 22:47:46,811 - INFO - 
Fold 2 Results:
2026-01-12 22:47:46,812 - INFO -   Night-level:
2026-01-12 22:47:46,812 - INFO -   Night-level:
2026-01-12 22:47:46,813 - INFO -     Accuracy: 0.8838
2026-01-12 22:47:46,813 - INFO -     Accuracy: 0.8838
2026-01-12 22:47:46,814 - INFO -     ROC-AUC: 0.9482
2026-01-12 22:47:46,814 - INFO -     ROC-AUC: 0.9482
2026-01-12 22:47:46,815 - INFO -   Participant-level (CLINICAL):
2026-01-12 22:47:46,815 - INFO -   Participant-level (CLINICAL):
2026-01-12 22:47:46,815 - INFO -     Accuracy: 0.8824
2026-01-12 22:47:46,815 - INFO -     Accuracy: 0.8824
2026-01-12 22:47:46,816 - INFO -     Precision: 0.8000
2026-01-12 22:47:46,816 - INFO -     Precision: 0.8000
2026-01-12 22:47:46,817 - INFO -     Recall: 1.0000
2026-01-12 22:47:46,817 - INFO -     Recall: 1.0000
2026-01-12 22:47:46,818 - INFO -     F1: 0.8889
2026-01-12 22:47:46,818 - INFO -     F1: 0.8889
2026-01-12 22:47:46,819 - INFO -     ROC-AUC: 0.9861
2026-01-12 22:47:46,819 - INFO -     ROC-AUC: 0.9861
2026-01-12 22:47:46,820 - INFO - 
======================================================================
2026-01-12 22:47:46,820 - INFO - 
======================================================================
2026-01-12 22:47:46,820 - INFO - FOLD 3/5
2026-01-12 22:47:46,820 - INFO - FOLD 3/5
2026-01-12 22:47:46,821 - INFO - ======================================================================
2026-01-12 22:47:46,821 - INFO - ======================================================================
2026-01-12 22:47:46,822 - INFO - Train nights: 1646, Test nights: 412
2026-01-12 22:47:46,822 - INFO - Train nights: 1646, Test nights: 412
2026-01-12 22:47:46,823 - INFO - Train participants: 67, Test participants: 17
2026-01-12 22:47:46,823 - INFO - Train participants: 67, Test participants: 17
2026-01-12 22:49:58,292 - INFO - Epoch 5/50 - Train Loss: 0.2161, Val Loss: 0.5600
2026-01-12 22:49:58,292 - INFO - Epoch 5/50 - Train Loss: 0.2161, Val Loss: 0.5600
2026-01-12 22:52:11,523 - INFO - Epoch 10/50 - Train Loss: 0.1671, Val Loss: 0.5494
2026-01-12 22:52:11,523 - INFO - Epoch 10/50 - Train Loss: 0.1671, Val Loss: 0.5494
2026-01-12 22:52:38,267 - INFO - Early stopping at epoch 11
2026-01-12 22:52:38,267 - INFO - Early stopping at epoch 11
2026-01-12 22:52:42,317 - INFO - 
Fold 3 Results:
2026-01-12 22:52:42,317 - INFO - 
Fold 3 Results:
2026-01-12 22:52:42,318 - INFO -   Night-level:
2026-01-12 22:52:42,318 - INFO -   Night-level:
2026-01-12 22:52:42,319 - INFO -     Accuracy: 0.8252
2026-01-12 22:52:42,319 - INFO -     Accuracy: 0.8252
2026-01-12 22:52:42,320 - INFO -     ROC-AUC: 0.9162
2026-01-12 22:52:42,320 - INFO -     ROC-AUC: 0.9162
2026-01-12 22:52:42,320 - INFO -   Participant-level (CLINICAL):
2026-01-12 22:52:42,320 - INFO -   Participant-level (CLINICAL):
2026-01-12 22:52:42,321 - INFO -     Accuracy: 0.7647
2026-01-12 22:52:42,321 - INFO -     Accuracy: 0.7647
2026-01-12 22:52:42,322 - INFO -     Precision: 0.6667
2026-01-12 22:52:42,322 - INFO -     Precision: 0.6667
2026-01-12 22:52:42,323 - INFO -     Recall: 0.8571
2026-01-12 22:52:42,323 - INFO -     Recall: 0.8571
2026-01-12 22:52:42,323 - INFO -     F1: 0.7500
2026-01-12 22:52:42,323 - INFO -     F1: 0.7500
2026-01-12 22:52:42,324 - INFO -     ROC-AUC: 0.9571
2026-01-12 22:52:42,324 - INFO -     ROC-AUC: 0.9571
2026-01-12 22:52:42,324 - INFO - 
======================================================================
2026-01-12 22:52:42,324 - INFO - 
======================================================================
2026-01-12 22:52:42,325 - INFO - FOLD 4/5
2026-01-12 22:52:42,325 - INFO - FOLD 4/5
2026-01-12 22:52:42,325 - INFO - ======================================================================
2026-01-12 22:52:42,325 - INFO - ======================================================================
2026-01-12 22:52:42,327 - INFO - Train nights: 1652, Test nights: 406
2026-01-12 22:52:42,327 - INFO - Train nights: 1652, Test nights: 406
2026-01-12 22:52:42,328 - INFO - Train participants: 68, Test participants: 16
2026-01-12 22:52:42,328 - INFO - Train participants: 68, Test participants: 16
2026-01-12 22:54:56,709 - INFO - Epoch 5/50 - Train Loss: 0.2233, Val Loss: 0.6081
2026-01-12 22:54:56,709 - INFO - Epoch 5/50 - Train Loss: 0.2233, Val Loss: 0.6081
2026-01-12 22:57:10,986 - INFO - Epoch 10/50 - Train Loss: 0.1304, Val Loss: 0.4762
2026-01-12 22:57:10,986 - INFO - Epoch 10/50 - Train Loss: 0.1304, Val Loss: 0.4762
2026-01-12 22:57:37,874 - INFO - Early stopping at epoch 11
2026-01-12 22:57:37,874 - INFO - Early stopping at epoch 11
2026-01-12 22:57:41,886 - INFO - 
Fold 4 Results:
2026-01-12 22:57:41,886 - INFO - 
Fold 4 Results:
2026-01-12 22:57:41,887 - INFO -   Night-level:
2026-01-12 22:57:41,887 - INFO -   Night-level:
2026-01-12 22:57:41,888 - INFO -     Accuracy: 0.8719
2026-01-12 22:57:41,888 - INFO -     Accuracy: 0.8719
2026-01-12 22:57:41,888 - INFO -     ROC-AUC: 0.9104
2026-01-12 22:57:41,888 - INFO -     ROC-AUC: 0.9104
2026-01-12 22:57:41,898 - INFO -   Participant-level (CLINICAL):
2026-01-12 22:57:41,898 - INFO -   Participant-level (CLINICAL):
2026-01-12 22:57:41,898 - INFO -     Accuracy: 0.8750
2026-01-12 22:57:41,898 - INFO -     Accuracy: 0.8750
2026-01-12 22:57:41,899 - INFO -     Precision: 0.8889
2026-01-12 22:57:41,899 - INFO -     Precision: 0.8889
2026-01-12 22:57:41,899 - INFO -     Recall: 0.8889
2026-01-12 22:57:41,899 - INFO -     Recall: 0.8889
2026-01-12 22:57:41,900 - INFO -     F1: 0.8889
2026-01-12 22:57:41,900 - INFO -     F1: 0.8889
2026-01-12 22:57:41,900 - INFO -     ROC-AUC: 0.9841
2026-01-12 22:57:41,900 - INFO -     ROC-AUC: 0.9841
2026-01-12 22:57:41,901 - INFO - 
======================================================================
2026-01-12 22:57:41,901 - INFO - 
======================================================================
2026-01-12 22:57:41,901 - INFO - FOLD 5/5
2026-01-12 22:57:41,901 - INFO - FOLD 5/5
2026-01-12 22:57:41,902 - INFO - ======================================================================
2026-01-12 22:57:41,902 - INFO - ======================================================================
2026-01-12 22:57:41,903 - INFO - Train nights: 1646, Test nights: 412
2026-01-12 22:57:41,903 - INFO - Train nights: 1646, Test nights: 412
2026-01-12 22:57:41,904 - INFO - Train participants: 67, Test participants: 17
2026-01-12 22:57:41,904 - INFO - Train participants: 67, Test participants: 17
2026-01-12 22:59:55,901 - INFO - Epoch 5/50 - Train Loss: 0.1978, Val Loss: 0.7367
2026-01-12 22:59:55,901 - INFO - Epoch 5/50 - Train Loss: 0.1978, Val Loss: 0.7367
2026-01-12 23:02:07,832 - INFO - Epoch 10/50 - Train Loss: 0.1421, Val Loss: 0.6624
2026-01-12 23:02:07,832 - INFO - Epoch 10/50 - Train Loss: 0.1421, Val Loss: 0.6624
2026-01-12 23:02:34,142 - INFO - Early stopping at epoch 11
2026-01-12 23:02:34,142 - INFO - Early stopping at epoch 11
2026-01-12 23:02:38,113 - INFO - 
Fold 5 Results:
2026-01-12 23:02:38,113 - INFO - 
Fold 5 Results:
2026-01-12 23:02:38,114 - INFO -   Night-level:
2026-01-12 23:02:38,114 - INFO -   Night-level:
2026-01-12 23:02:38,115 - INFO -     Accuracy: 0.8107
2026-01-12 23:02:38,115 - INFO -     Accuracy: 0.8107
2026-01-12 23:02:38,115 - INFO -     ROC-AUC: 0.8779
2026-01-12 23:02:38,115 - INFO -     ROC-AUC: 0.8779
2026-01-12 23:02:38,116 - INFO -   Participant-level (CLINICAL):
2026-01-12 23:02:38,116 - INFO -   Participant-level (CLINICAL):
2026-01-12 23:02:38,117 - INFO -     Accuracy: 0.8824
2026-01-12 23:02:38,117 - INFO -     Accuracy: 0.8824
2026-01-12 23:02:38,117 - INFO -     Precision: 0.9091
2026-01-12 23:02:38,117 - INFO -     Precision: 0.9091
2026-01-12 23:02:38,118 - INFO -     Recall: 0.9091
2026-01-12 23:02:38,118 - INFO -     Recall: 0.9091
2026-01-12 23:02:38,119 - INFO -     F1: 0.9091
2026-01-12 23:02:38,119 - INFO -     F1: 0.9091
2026-01-12 23:02:38,119 - INFO -     ROC-AUC: 0.9697
2026-01-12 23:02:38,119 - INFO -     ROC-AUC: 0.9697
2026-01-12 23:02:38,120 - INFO - 
======================================================================
2026-01-12 23:02:38,120 - INFO - 
======================================================================
2026-01-12 23:02:38,121 - INFO - AVERAGE RESULTS ACROSS ALL FOLDS
2026-01-12 23:02:38,121 - INFO - AVERAGE RESULTS ACROSS ALL FOLDS
2026-01-12 23:02:38,122 - INFO - ======================================================================
2026-01-12 23:02:38,122 - INFO - ======================================================================
2026-01-12 23:02:38,122 - INFO - Night-level:
2026-01-12 23:02:38,122 - INFO - Night-level:
2026-01-12 23:02:38,123 - INFO -   Accuracy: 0.8639 ± 0.0421
2026-01-12 23:02:38,123 - INFO -   Accuracy: 0.8639 ± 0.0421
2026-01-12 23:02:38,124 - INFO -   ROC-AUC: 0.9278 ± 0.0368
2026-01-12 23:02:38,124 - INFO -   ROC-AUC: 0.9278 ± 0.0368
2026-01-12 23:02:38,125 - INFO - Participant-level (CLINICAL PERFORMANCE):
2026-01-12 23:02:38,125 - INFO - Participant-level (CLINICAL PERFORMANCE):
2026-01-12 23:02:38,125 - INFO -   Accuracy: 0.8809 ± 0.0745
2026-01-12 23:02:38,125 - INFO -   Accuracy: 0.8809 ± 0.0745
2026-01-12 23:02:38,126 - INFO -   Precision: 0.8529 ± 0.1128
2026-01-12 23:02:38,126 - INFO -   Precision: 0.8529 ± 0.1128
2026-01-12 23:02:38,126 - INFO -   Recall: 0.9310 ± 0.0587
2026-01-12 23:02:38,126 - INFO -   Recall: 0.9310 ± 0.0587
2026-01-12 23:02:38,127 - INFO -   F1: 0.8874 ± 0.0800
2026-01-12 23:02:38,127 - INFO -   F1: 0.8874 ± 0.0800
2026-01-12 23:02:38,128 - INFO -   ROC-AUC: 0.9794 ± 0.0147
2026-01-12 23:02:38,128 - INFO -   ROC-AUC: 0.9794 ± 0.0147
2026-01-12 23:02:38,136 - INFO - 
Results saved to: /work3/s184484/iRBD-detection/results/lstm_v0_night_level/results_20260112_230238.json
2026-01-12 23:02:38,136 - INFO - 
Results saved to: /work3/s184484/iRBD-detection/results/lstm_v0_night_level/results_20260112_230238.json
2026-01-12 23:02:38,595 - INFO - 
======================================================================
2026-01-12 23:02:38,595 - INFO - NIGHT-LEVEL LSTM TRAINING COMPLETED SUCCESSFULLY!
2026-01-12 23:02:38,596 - INFO - ======================================================================
