2026-01-28 04:54:25,671 - INFO - Initialized ML Baselines Night-Level (version=vvt)
2026-01-28 04:54:25,672 - INFO - Features directory: /work3/s184484/iRBD-detection/data/features_vvt
2026-01-28 04:54:25,672 - INFO - Results directory: /work3/s184484/iRBD-detection/results/ml_baselines_vvt
2026-01-28 04:54:25,673 - INFO - Log file: /work3/s184484/iRBD-detection/results/ml_baselines_vvt/training.log
2026-01-28 04:54:25,673 - INFO - ======================================================================
2026-01-28 04:54:25,674 - INFO - STARTING NIGHT-LEVEL CLASSIFICATION
2026-01-28 04:54:25,674 - INFO - ======================================================================
2026-01-28 04:54:25,675 - INFO - Preparing night-level dataset...
2026-01-28 04:54:25,677 - INFO - Found 42 control participants
2026-01-28 04:55:06,770 - INFO - Found 42 iRBD participants
2026-01-28 04:56:14,100 - INFO - Night-level dataset prepared:
2026-01-28 04:56:14,101 - INFO -   Total nights: 1815
2026-01-28 04:56:14,102 - INFO -   Control nights: 718
2026-01-28 04:56:14,103 - INFO -   iRBD nights: 1097
2026-01-28 04:56:14,103 - INFO -   Unique participants: 84
2026-01-28 04:56:14,104 - INFO -   Feature dimension: 1024
2026-01-28 04:56:14,146 - INFO - XGBoost available
2026-01-28 04:56:14,147 - INFO - 
======================================================================
2026-01-28 04:56:14,147 - INFO - Training Random Forest
2026-01-28 04:56:14,148 - INFO - ======================================================================
2026-01-28 04:56:14,149 - INFO - 
Fold 1/5
2026-01-28 04:56:14,874 - INFO -   Night-level metrics:
2026-01-28 04:56:14,874 - INFO -     Accuracy: 0.7418
2026-01-28 04:56:14,875 - INFO -     ROC-AUC: 0.8312
2026-01-28 04:56:14,875 - INFO -   Participant-level metrics:
2026-01-28 04:56:14,876 - INFO -     Accuracy: 0.7647
2026-01-28 04:56:14,876 - INFO -     ROC-AUC: 0.8636
2026-01-28 04:56:14,877 - INFO -     Test participants: 17
2026-01-28 04:56:14,877 - INFO - 
Fold 2/5
2026-01-28 04:56:15,576 - INFO -   Night-level metrics:
2026-01-28 04:56:15,577 - INFO -     Accuracy: 0.8681
2026-01-28 04:56:15,577 - INFO -     ROC-AUC: 0.9420
2026-01-28 04:56:15,578 - INFO -   Participant-level metrics:
2026-01-28 04:56:15,578 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:15,578 - INFO -     ROC-AUC: 0.9861
2026-01-28 04:56:15,579 - INFO -     Test participants: 17
2026-01-28 04:56:15,579 - INFO - 
Fold 3/5
2026-01-28 04:56:16,296 - INFO -   Night-level metrics:
2026-01-28 04:56:16,296 - INFO -     Accuracy: 0.8778
2026-01-28 04:56:16,297 - INFO -     ROC-AUC: 0.9655
2026-01-28 04:56:16,297 - INFO -   Participant-level metrics:
2026-01-28 04:56:16,298 - INFO -     Accuracy: 0.9375
2026-01-28 04:56:16,298 - INFO -     ROC-AUC: 1.0000
2026-01-28 04:56:16,299 - INFO -     Test participants: 16
2026-01-28 04:56:16,299 - INFO - 
Fold 4/5
2026-01-28 04:56:17,016 - INFO -   Night-level metrics:
2026-01-28 04:56:17,017 - INFO -     Accuracy: 0.9093
2026-01-28 04:56:17,018 - INFO -     ROC-AUC: 0.9684
2026-01-28 04:56:17,018 - INFO -   Participant-level metrics:
2026-01-28 04:56:17,019 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:17,019 - INFO -     ROC-AUC: 0.9722
2026-01-28 04:56:17,020 - INFO -     Test participants: 17
2026-01-28 04:56:17,020 - INFO - 
Fold 5/5
2026-01-28 04:56:17,703 - INFO -   Night-level metrics:
2026-01-28 04:56:17,703 - INFO -     Accuracy: 0.8209
2026-01-28 04:56:17,704 - INFO -     ROC-AUC: 0.9319
2026-01-28 04:56:17,704 - INFO -   Participant-level metrics:
2026-01-28 04:56:17,705 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:17,705 - INFO -     ROC-AUC: 0.9242
2026-01-28 04:56:17,706 - INFO -     Test participants: 17
2026-01-28 04:56:17,706 - INFO - 
Random Forest - Average Results:
2026-01-28 04:56:17,707 - INFO -   Night-level:
2026-01-28 04:56:17,707 - INFO -     Accuracy: 0.8436 ± 0.0583
2026-01-28 04:56:17,708 - INFO -     ROC-AUC: 0.9278 ± 0.0502
2026-01-28 04:56:17,708 - INFO -   Participant-level (CLINICAL PERFORMANCE):
2026-01-28 04:56:17,709 - INFO -     Accuracy: 0.8699 ± 0.0567
2026-01-28 04:56:17,709 - INFO -     Precision: 0.8529 ± 0.1128
2026-01-28 04:56:17,710 - INFO -     Recall: 0.8679 ± 0.1097
2026-01-28 04:56:17,710 - INFO -     F1: 0.8574 ± 0.0967
2026-01-28 04:56:17,711 - INFO -     ROC-AUC: 0.9492 ± 0.0498
2026-01-28 04:56:17,711 - INFO - 
======================================================================
2026-01-28 04:56:17,712 - INFO - Training Logistic Regression
2026-01-28 04:56:17,712 - INFO - ======================================================================
2026-01-28 04:56:17,713 - INFO - 
Fold 1/5
2026-01-28 04:56:19,761 - INFO -   Night-level metrics:
2026-01-28 04:56:19,762 - INFO -     Accuracy: 0.7830
2026-01-28 04:56:19,762 - INFO -     ROC-AUC: 0.8392
2026-01-28 04:56:19,763 - INFO -   Participant-level metrics:
2026-01-28 04:56:19,764 - INFO -     Accuracy: 0.8235
2026-01-28 04:56:19,764 - INFO -     ROC-AUC: 0.8636
2026-01-28 04:56:19,764 - INFO -     Test participants: 17
2026-01-28 04:56:19,765 - INFO - 
Fold 2/5
2026-01-28 04:56:21,418 - INFO -   Night-level metrics:
2026-01-28 04:56:21,419 - INFO -     Accuracy: 0.8709
2026-01-28 04:56:21,419 - INFO -     ROC-AUC: 0.9488
2026-01-28 04:56:21,420 - INFO -   Participant-level metrics:
2026-01-28 04:56:21,420 - INFO -     Accuracy: 0.9412
2026-01-28 04:56:21,421 - INFO -     ROC-AUC: 1.0000
2026-01-28 04:56:21,421 - INFO -     Test participants: 17
2026-01-28 04:56:21,422 - INFO - 
Fold 3/5
2026-01-28 04:56:23,080 - INFO -   Night-level metrics:
2026-01-28 04:56:23,081 - INFO -     Accuracy: 0.8389
2026-01-28 04:56:23,081 - INFO -     ROC-AUC: 0.9181
2026-01-28 04:56:23,082 - INFO -   Participant-level metrics:
2026-01-28 04:56:23,082 - INFO -     Accuracy: 0.8750
2026-01-28 04:56:23,083 - INFO -     ROC-AUC: 1.0000
2026-01-28 04:56:23,083 - INFO -     Test participants: 16
2026-01-28 04:56:23,084 - INFO - 
Fold 4/5
2026-01-28 04:56:24,734 - INFO -   Night-level metrics:
2026-01-28 04:56:24,735 - INFO -     Accuracy: 0.9231
2026-01-28 04:56:24,736 - INFO -     ROC-AUC: 0.9719
2026-01-28 04:56:24,736 - INFO -   Participant-level metrics:
2026-01-28 04:56:24,737 - INFO -     Accuracy: 1.0000
2026-01-28 04:56:24,737 - INFO -     ROC-AUC: 1.0000
2026-01-28 04:56:24,737 - INFO -     Test participants: 17
2026-01-28 04:56:24,738 - INFO - 
Fold 5/5
2026-01-28 04:56:26,368 - INFO -   Night-level metrics:
2026-01-28 04:56:26,369 - INFO -     Accuracy: 0.7961
2026-01-28 04:56:26,369 - INFO -     ROC-AUC: 0.7984
2026-01-28 04:56:26,370 - INFO -   Participant-level metrics:
2026-01-28 04:56:26,370 - INFO -     Accuracy: 0.8235
2026-01-28 04:56:26,370 - INFO -     ROC-AUC: 0.9242
2026-01-28 04:56:26,371 - INFO -     Test participants: 17
2026-01-28 04:56:26,371 - INFO - 
Logistic Regression - Average Results:
2026-01-28 04:56:26,372 - INFO -   Night-level:
2026-01-28 04:56:26,372 - INFO -     Accuracy: 0.8424 ± 0.0510
2026-01-28 04:56:26,373 - INFO -     ROC-AUC: 0.8953 ± 0.0660
2026-01-28 04:56:26,373 - INFO -   Participant-level (CLINICAL PERFORMANCE):
2026-01-28 04:56:26,374 - INFO -     Accuracy: 0.8926 ± 0.0689
2026-01-28 04:56:26,374 - INFO -     Precision: 0.8473 ± 0.0950
2026-01-28 04:56:26,375 - INFO -     Recall: 0.9485 ± 0.0675
2026-01-28 04:56:26,375 - INFO -     F1: 0.8938 ± 0.0770
2026-01-28 04:56:26,375 - INFO -     ROC-AUC: 0.9576 ± 0.0554
2026-01-28 04:56:26,376 - INFO - 
======================================================================
2026-01-28 04:56:26,376 - INFO - Training SVM
2026-01-28 04:56:26,377 - INFO - ======================================================================
2026-01-28 04:56:26,378 - INFO - 
Fold 1/5
2026-01-28 04:56:28,250 - INFO -   Night-level metrics:
2026-01-28 04:56:28,250 - INFO -     Accuracy: 0.7390
2026-01-28 04:56:28,251 - INFO -     ROC-AUC: 0.8380
2026-01-28 04:56:28,252 - INFO -   Participant-level metrics:
2026-01-28 04:56:28,252 - INFO -     Accuracy: 0.7647
2026-01-28 04:56:28,253 - INFO -     ROC-AUC: 0.8485
2026-01-28 04:56:28,253 - INFO -     Test participants: 17
2026-01-28 04:56:28,253 - INFO - 
Fold 2/5
2026-01-28 04:56:30,041 - INFO -   Night-level metrics:
2026-01-28 04:56:30,041 - INFO -     Accuracy: 0.8654
2026-01-28 04:56:30,042 - INFO -     ROC-AUC: 0.9209
2026-01-28 04:56:30,042 - INFO -   Participant-level metrics:
2026-01-28 04:56:30,043 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:30,043 - INFO -     ROC-AUC: 0.9028
2026-01-28 04:56:30,044 - INFO -     Test participants: 17
2026-01-28 04:56:30,044 - INFO - 
Fold 3/5
2026-01-28 04:56:31,900 - INFO -   Night-level metrics:
2026-01-28 04:56:31,901 - INFO -     Accuracy: 0.8694
2026-01-28 04:56:31,901 - INFO -     ROC-AUC: 0.9470
2026-01-28 04:56:31,902 - INFO -   Participant-level metrics:
2026-01-28 04:56:31,902 - INFO -     Accuracy: 0.9375
2026-01-28 04:56:31,903 - INFO -     ROC-AUC: 0.9688
2026-01-28 04:56:31,903 - INFO -     Test participants: 16
2026-01-28 04:56:31,904 - INFO - 
Fold 4/5
2026-01-28 04:56:33,923 - INFO -   Night-level metrics:
2026-01-28 04:56:33,923 - INFO -     Accuracy: 0.9066
2026-01-28 04:56:33,924 - INFO -     ROC-AUC: 0.9666
2026-01-28 04:56:33,924 - INFO -   Participant-level metrics:
2026-01-28 04:56:33,925 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:33,925 - INFO -     ROC-AUC: 0.9861
2026-01-28 04:56:33,925 - INFO -     Test participants: 17
2026-01-28 04:56:33,926 - INFO - 
Fold 5/5
2026-01-28 04:56:35,674 - INFO -   Night-level metrics:
2026-01-28 04:56:35,675 - INFO -     Accuracy: 0.8347
2026-01-28 04:56:35,675 - INFO -     ROC-AUC: 0.9140
2026-01-28 04:56:35,676 - INFO -   Participant-level metrics:
2026-01-28 04:56:35,676 - INFO -     Accuracy: 0.8235
2026-01-28 04:56:35,677 - INFO -     ROC-AUC: 0.9697
2026-01-28 04:56:35,677 - INFO -     Test participants: 17
2026-01-28 04:56:35,678 - INFO - 
SVM - Average Results:
2026-01-28 04:56:35,678 - INFO -   Night-level:
2026-01-28 04:56:35,678 - INFO -     Accuracy: 0.8430 ± 0.0568
2026-01-28 04:56:35,679 - INFO -     ROC-AUC: 0.9173 ± 0.0439
2026-01-28 04:56:35,679 - INFO -   Participant-level (CLINICAL PERFORMANCE):
2026-01-28 04:56:35,680 - INFO -     Accuracy: 0.8581 ± 0.0590
2026-01-28 04:56:35,680 - INFO -     Precision: 0.8294 ± 0.1227
2026-01-28 04:56:35,681 - INFO -     Recall: 0.9013 ± 0.0553
2026-01-28 04:56:35,681 - INFO -     F1: 0.8590 ± 0.0753
2026-01-28 04:56:35,682 - INFO -     ROC-AUC: 0.9352 ± 0.0519
2026-01-28 04:56:35,682 - INFO - 
======================================================================
2026-01-28 04:56:35,683 - INFO - Training XGBoost
2026-01-28 04:56:35,683 - INFO - ======================================================================
2026-01-28 04:56:35,684 - INFO - 
Fold 1/5
2026-01-28 04:56:46,384 - INFO -   Night-level metrics:
2026-01-28 04:56:46,384 - INFO -     Accuracy: 0.7143
2026-01-28 04:56:46,385 - INFO -     ROC-AUC: 0.8005
2026-01-28 04:56:46,385 - INFO -   Participant-level metrics:
2026-01-28 04:56:46,386 - INFO -     Accuracy: 0.7647
2026-01-28 04:56:46,386 - INFO -     ROC-AUC: 0.8182
2026-01-28 04:56:46,387 - INFO -     Test participants: 17
2026-01-28 04:56:46,387 - INFO - 
Fold 2/5
2026-01-28 04:56:57,621 - INFO -   Night-level metrics:
2026-01-28 04:56:57,622 - INFO -     Accuracy: 0.8516
2026-01-28 04:56:57,623 - INFO -     ROC-AUC: 0.9357
2026-01-28 04:56:57,623 - INFO -   Participant-level metrics:
2026-01-28 04:56:57,623 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:57,624 - INFO -     ROC-AUC: 0.9722
2026-01-28 04:56:57,624 - INFO -     Test participants: 17
2026-01-28 04:56:57,625 - INFO - 
Fold 3/5
2026-01-28 04:57:09,160 - INFO -   Night-level metrics:
2026-01-28 04:57:09,161 - INFO -     Accuracy: 0.8833
2026-01-28 04:57:09,161 - INFO -     ROC-AUC: 0.9607
2026-01-28 04:57:09,162 - INFO -   Participant-level metrics:
2026-01-28 04:57:09,162 - INFO -     Accuracy: 0.9375
2026-01-28 04:57:09,162 - INFO -     ROC-AUC: 0.9844
2026-01-28 04:57:09,163 - INFO -     Test participants: 16
2026-01-28 04:57:09,163 - INFO - 
Fold 4/5
2026-01-28 04:57:20,859 - INFO -   Night-level metrics:
2026-01-28 04:57:20,860 - INFO -     Accuracy: 0.8984
2026-01-28 04:57:20,860 - INFO -     ROC-AUC: 0.9692
2026-01-28 04:57:20,861 - INFO -   Participant-level metrics:
2026-01-28 04:57:20,861 - INFO -     Accuracy: 0.9412
2026-01-28 04:57:20,862 - INFO -     ROC-AUC: 0.9444
2026-01-28 04:57:20,862 - INFO -     Test participants: 17
2026-01-28 04:57:20,863 - INFO - 
Fold 5/5
2026-01-28 04:57:32,306 - INFO -   Night-level metrics:
2026-01-28 04:57:32,307 - INFO -     Accuracy: 0.8154
2026-01-28 04:57:32,308 - INFO -     ROC-AUC: 0.9114
2026-01-28 04:57:32,308 - INFO -   Participant-level metrics:
2026-01-28 04:57:32,308 - INFO -     Accuracy: 0.8235
2026-01-28 04:57:32,309 - INFO -     ROC-AUC: 0.9394
2026-01-28 04:57:32,309 - INFO -     Test participants: 17
2026-01-28 04:57:32,310 - INFO - 
XGBoost - Average Results:
2026-01-28 04:57:32,310 - INFO -   Night-level:
2026-01-28 04:57:32,311 - INFO -     Accuracy: 0.8326 ± 0.0657
2026-01-28 04:57:32,311 - INFO -     ROC-AUC: 0.9155 ± 0.0609
2026-01-28 04:57:32,312 - INFO -   Participant-level (CLINICAL PERFORMANCE):
2026-01-28 04:57:32,312 - INFO -     Accuracy: 0.8699 ± 0.0679
2026-01-28 04:57:32,313 - INFO -     Precision: 0.8378 ± 0.1092
2026-01-28 04:57:32,313 - INFO -     Recall: 0.8929 ± 0.1220
2026-01-28 04:57:32,314 - INFO -     F1: 0.8615 ± 0.1015
2026-01-28 04:57:32,314 - INFO -     ROC-AUC: 0.9317 ± 0.0592
2026-01-28 04:57:32,335 - INFO - 
Results saved to: /work3/s184484/iRBD-detection/results/ml_baselines_vvt/results_20260128_045732.json
2026-01-28 04:57:32,346 - INFO - Summary saved to: /work3/s184484/iRBD-detection/results/ml_baselines_vvt/summary_20260128_045732.csv
2026-01-28 04:57:32,346 - INFO - 
Summary Table:
2026-01-28 04:57:32,352 - INFO - 
         Classifier  Night_Accuracy  Night_ROC_AUC  Participant_Accuracy  Participant_Precision  Participant_Recall  Participant_F1  Participant_ROC_AUC
      Random Forest        0.843589       0.927810              0.869853               0.852929            0.867929        0.857374             0.949242
Logistic Regression        0.842391       0.895273              0.892647               0.847302            0.948485        0.893772             0.957576
                SVM        0.843029       0.917279              0.858088               0.829444            0.901263        0.858992             0.935164
            XGBoost        0.832609       0.915509              0.869853               0.837778            0.892929        0.861495             0.931723
2026-01-28 04:57:32,357 - INFO - 
Random Forest feature importance saved to: /work3/s184484/iRBD-detection/results/ml_baselines_vvt/feature_importance_rf.json
2026-01-28 04:57:32,358 - INFO - 
Top 10 Most Important Features (Random Forest):
2026-01-28 04:57:32,358 - INFO -   1. SSL_Feature_691: 0.034866 +/- 0.006660
2026-01-28 04:57:32,359 - INFO -   2. SSL_Feature_1: 0.028305 +/- 0.004473
2026-01-28 04:57:32,359 - INFO -   3. SSL_Feature_514: 0.024933 +/- 0.003420
2026-01-28 04:57:32,360 - INFO -   4. SSL_Feature_335: 0.021828 +/- 0.004572
2026-01-28 04:57:32,360 - INFO -   5. SSL_Feature_478: 0.019801 +/- 0.004752
2026-01-28 04:57:32,360 - INFO -   6. SSL_Feature_294: 0.019779 +/- 0.001683
2026-01-28 04:57:32,361 - INFO -   7. SSL_Feature_859: 0.018352 +/- 0.006875
2026-01-28 04:57:32,361 - INFO -   8. SSL_Feature_405: 0.017623 +/- 0.001506
2026-01-28 04:57:32,362 - INFO -   9. SSL_Feature_481: 0.016924 +/- 0.003744
2026-01-28 04:57:32,362 - INFO -   10. SSL_Feature_534: 0.014101 +/- 0.003515
2026-01-28 04:57:32,367 - INFO - 
XGBoost feature importance saved to: /work3/s184484/iRBD-detection/results/ml_baselines_vvt/feature_importance_xgb.json
2026-01-28 04:57:32,367 - INFO - 
Top 10 Most Important Features (XGBoost):
2026-01-28 04:57:32,368 - INFO -   1. SSL_Feature_478: 0.050033 +/- 0.065845
2026-01-28 04:57:32,368 - INFO -   2. SSL_Feature_769: 0.042778 +/- 0.023323
2026-01-28 04:57:32,368 - INFO -   3. SSL_Feature_691: 0.040766 +/- 0.038709
2026-01-28 04:57:32,369 - INFO -   4. SSL_Feature_481: 0.014494 +/- 0.019471
2026-01-28 04:57:32,369 - INFO -   5. SSL_Feature_751: 0.012881 +/- 0.010633
2026-01-28 04:57:32,370 - INFO -   6. SSL_Feature_335: 0.007924 +/- 0.003443
2026-01-28 04:57:32,370 - INFO -   7. SSL_Feature_237: 0.006600 +/- 0.008782
2026-01-28 04:57:32,370 - INFO -   8. SSL_Feature_57: 0.006560 +/- 0.007852
2026-01-28 04:57:32,371 - INFO -   9. SSL_Feature_944: 0.006098 +/- 0.003418
2026-01-28 04:57:32,371 - INFO -   10. SSL_Feature_348: 0.006056 +/- 0.006148
2026-01-28 04:57:32,373 - INFO - 
======================================================================
2026-01-28 04:57:32,373 - INFO - NIGHT-LEVEL CLASSIFICATION COMPLETED SUCCESSFULLY!
2026-01-28 04:57:32,374 - INFO - ======================================================================
