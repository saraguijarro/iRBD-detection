2026-01-28 04:54:20,448 - INFO - Initialized ML Baselines Night-Level (version=v0)
2026-01-28 04:54:20,449 - INFO - Features directory: /work3/s184484/iRBD-detection/data/features_v0
2026-01-28 04:54:20,450 - INFO - Results directory: /work3/s184484/iRBD-detection/results/ml_baselines_v0
2026-01-28 04:54:20,450 - INFO - Log file: /work3/s184484/iRBD-detection/results/ml_baselines_v0/training.log
2026-01-28 04:54:20,451 - INFO - ======================================================================
2026-01-28 04:54:20,452 - INFO - STARTING NIGHT-LEVEL CLASSIFICATION
2026-01-28 04:54:20,453 - INFO - ======================================================================
2026-01-28 04:54:20,453 - INFO - Preparing night-level dataset...
2026-01-28 04:54:20,456 - INFO - Found 42 control participants
2026-01-28 04:55:01,976 - INFO - Found 42 iRBD participants
2026-01-28 04:56:06,925 - INFO - Night-level dataset prepared:
2026-01-28 04:56:06,925 - INFO -   Total nights: 2058
2026-01-28 04:56:06,926 - INFO -   Control nights: 832
2026-01-28 04:56:06,926 - INFO -   iRBD nights: 1226
2026-01-28 04:56:06,927 - INFO -   Unique participants: 84
2026-01-28 04:56:06,928 - INFO -   Feature dimension: 1024
2026-01-28 04:56:06,981 - INFO - XGBoost available
2026-01-28 04:56:06,982 - INFO - 
======================================================================
2026-01-28 04:56:06,983 - INFO - Training Random Forest
2026-01-28 04:56:06,983 - INFO - ======================================================================
2026-01-28 04:56:06,985 - INFO - 
Fold 1/5
2026-01-28 04:56:07,765 - INFO -   Night-level metrics:
2026-01-28 04:56:07,766 - INFO -     Accuracy: 0.8096
2026-01-28 04:56:07,766 - INFO -     ROC-AUC: 0.9439
2026-01-28 04:56:07,767 - INFO -   Participant-level metrics:
2026-01-28 04:56:07,767 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:07,768 - INFO -     ROC-AUC: 0.9857
2026-01-28 04:56:07,768 - INFO -     Test participants: 17
2026-01-28 04:56:07,769 - INFO - 
Fold 2/5
2026-01-28 04:56:08,511 - INFO -   Night-level metrics:
2026-01-28 04:56:08,512 - INFO -     Accuracy: 0.8039
2026-01-28 04:56:08,513 - INFO -     ROC-AUC: 0.8708
2026-01-28 04:56:08,513 - INFO -   Participant-level metrics:
2026-01-28 04:56:08,514 - INFO -     Accuracy: 0.8235
2026-01-28 04:56:08,515 - INFO -     ROC-AUC: 0.9028
2026-01-28 04:56:08,515 - INFO -     Test participants: 17
2026-01-28 04:56:08,516 - INFO - 
Fold 3/5
2026-01-28 04:56:09,228 - INFO -   Night-level metrics:
2026-01-28 04:56:09,229 - INFO -     Accuracy: 0.7864
2026-01-28 04:56:09,230 - INFO -     ROC-AUC: 0.9102
2026-01-28 04:56:09,231 - INFO -   Participant-level metrics:
2026-01-28 04:56:09,232 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:09,232 - INFO -     ROC-AUC: 0.9429
2026-01-28 04:56:09,233 - INFO -     Test participants: 17
2026-01-28 04:56:09,234 - INFO - 
Fold 4/5
2026-01-28 04:56:09,978 - INFO -   Night-level metrics:
2026-01-28 04:56:09,979 - INFO -     Accuracy: 0.8547
2026-01-28 04:56:09,980 - INFO -     ROC-AUC: 0.9418
2026-01-28 04:56:09,980 - INFO -   Participant-level metrics:
2026-01-28 04:56:09,981 - INFO -     Accuracy: 0.8125
2026-01-28 04:56:09,982 - INFO -     ROC-AUC: 0.9683
2026-01-28 04:56:09,982 - INFO -     Test participants: 16
2026-01-28 04:56:09,983 - INFO - 
Fold 5/5
2026-01-28 04:56:10,726 - INFO -   Night-level metrics:
2026-01-28 04:56:10,727 - INFO -     Accuracy: 0.8107
2026-01-28 04:56:10,728 - INFO -     ROC-AUC: 0.8869
2026-01-28 04:56:10,728 - INFO -   Participant-level metrics:
2026-01-28 04:56:10,729 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:10,729 - INFO -     ROC-AUC: 0.9697
2026-01-28 04:56:10,730 - INFO -     Test participants: 17
2026-01-28 04:56:10,731 - INFO - 
Random Forest - Average Results:
2026-01-28 04:56:10,731 - INFO -   Night-level:
2026-01-28 04:56:10,732 - INFO -     Accuracy: 0.8131 ± 0.0226
2026-01-28 04:56:10,732 - INFO -     ROC-AUC: 0.9107 ± 0.0291
2026-01-28 04:56:10,733 - INFO -   Participant-level (CLINICAL PERFORMANCE):
2026-01-28 04:56:10,733 - INFO -     Accuracy: 0.8566 ± 0.0317
2026-01-28 04:56:10,734 - INFO -     Precision: 0.8394 ± 0.0530
2026-01-28 04:56:10,735 - INFO -     Recall: 0.8838 ± 0.0723
2026-01-28 04:56:10,735 - INFO -     F1: 0.8577 ± 0.0325
2026-01-28 04:56:10,736 - INFO -     ROC-AUC: 0.9539 ± 0.0290
2026-01-28 04:56:10,736 - INFO - 
======================================================================
2026-01-28 04:56:10,737 - INFO - Training Logistic Regression
2026-01-28 04:56:10,737 - INFO - ======================================================================
2026-01-28 04:56:10,740 - INFO - 
Fold 1/5
2026-01-28 04:56:13,229 - INFO -   Night-level metrics:
2026-01-28 04:56:13,230 - INFO -     Accuracy: 0.8530
2026-01-28 04:56:13,230 - INFO -     ROC-AUC: 0.9402
2026-01-28 04:56:13,231 - INFO -   Participant-level metrics:
2026-01-28 04:56:13,231 - INFO -     Accuracy: 1.0000
2026-01-28 04:56:13,232 - INFO -     ROC-AUC: 1.0000
2026-01-28 04:56:13,232 - INFO -     Test participants: 17
2026-01-28 04:56:13,233 - INFO - 
Fold 2/5
2026-01-28 04:56:15,240 - INFO -   Night-level metrics:
2026-01-28 04:56:15,241 - INFO -     Accuracy: 0.7700
2026-01-28 04:56:15,241 - INFO -     ROC-AUC: 0.8142
2026-01-28 04:56:15,242 - INFO -   Participant-level metrics:
2026-01-28 04:56:15,243 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:15,243 - INFO -     ROC-AUC: 0.9028
2026-01-28 04:56:15,244 - INFO -     Test participants: 17
2026-01-28 04:56:15,244 - INFO - 
Fold 3/5
2026-01-28 04:56:17,269 - INFO -   Night-level metrics:
2026-01-28 04:56:17,270 - INFO -     Accuracy: 0.7451
2026-01-28 04:56:17,270 - INFO -     ROC-AUC: 0.8318
2026-01-28 04:56:17,271 - INFO -   Participant-level metrics:
2026-01-28 04:56:17,272 - INFO -     Accuracy: 0.7647
2026-01-28 04:56:17,273 - INFO -     ROC-AUC: 0.8286
2026-01-28 04:56:17,273 - INFO -     Test participants: 17
2026-01-28 04:56:17,274 - INFO - 
Fold 4/5
2026-01-28 04:56:19,280 - INFO -   Night-level metrics:
2026-01-28 04:56:19,280 - INFO -     Accuracy: 0.8227
2026-01-28 04:56:19,281 - INFO -     ROC-AUC: 0.8722
2026-01-28 04:56:19,282 - INFO -   Participant-level metrics:
2026-01-28 04:56:19,282 - INFO -     Accuracy: 0.9375
2026-01-28 04:56:19,283 - INFO -     ROC-AUC: 0.9683
2026-01-28 04:56:19,284 - INFO -     Test participants: 16
2026-01-28 04:56:19,285 - INFO - 
Fold 5/5
2026-01-28 04:56:21,255 - INFO -   Night-level metrics:
2026-01-28 04:56:21,256 - INFO -     Accuracy: 0.7646
2026-01-28 04:56:21,256 - INFO -     ROC-AUC: 0.8485
2026-01-28 04:56:21,257 - INFO -   Participant-level metrics:
2026-01-28 04:56:21,258 - INFO -     Accuracy: 0.8235
2026-01-28 04:56:21,258 - INFO -     ROC-AUC: 0.9545
2026-01-28 04:56:21,259 - INFO -     Test participants: 17
2026-01-28 04:56:21,260 - INFO - 
Logistic Regression - Average Results:
2026-01-28 04:56:21,261 - INFO -   Night-level:
2026-01-28 04:56:21,261 - INFO -     Accuracy: 0.7911 ± 0.0402
2026-01-28 04:56:21,262 - INFO -     ROC-AUC: 0.8614 ± 0.0438
2026-01-28 04:56:21,263 - INFO -   Participant-level (CLINICAL PERFORMANCE):
2026-01-28 04:56:21,263 - INFO -     Accuracy: 0.8816 ± 0.0827
2026-01-28 04:56:21,264 - INFO -     Precision: 0.8779 ± 0.0924
2026-01-28 04:56:21,264 - INFO -     Recall: 0.8815 ± 0.1096
2026-01-28 04:56:21,265 - INFO -     F1: 0.8788 ± 0.0969
2026-01-28 04:56:21,266 - INFO -     ROC-AUC: 0.9308 ± 0.0600
2026-01-28 04:56:21,266 - INFO - 
======================================================================
2026-01-28 04:56:21,267 - INFO - Training SVM
2026-01-28 04:56:21,267 - INFO - ======================================================================
2026-01-28 04:56:21,268 - INFO - 
Fold 1/5
2026-01-28 04:56:23,811 - INFO -   Night-level metrics:
2026-01-28 04:56:23,812 - INFO -     Accuracy: 0.8024
2026-01-28 04:56:23,813 - INFO -     ROC-AUC: 0.9521
2026-01-28 04:56:23,814 - INFO -   Participant-level metrics:
2026-01-28 04:56:23,814 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:23,815 - INFO -     ROC-AUC: 1.0000
2026-01-28 04:56:23,816 - INFO -     Test participants: 17
2026-01-28 04:56:23,816 - INFO - 
Fold 2/5
2026-01-28 04:56:26,263 - INFO -   Night-level metrics:
2026-01-28 04:56:26,264 - INFO -     Accuracy: 0.8039
2026-01-28 04:56:26,265 - INFO -     ROC-AUC: 0.8957
2026-01-28 04:56:26,265 - INFO -   Participant-level metrics:
2026-01-28 04:56:26,266 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:26,267 - INFO -     ROC-AUC: 0.9167
2026-01-28 04:56:26,267 - INFO -     Test participants: 17
2026-01-28 04:56:26,268 - INFO - 
Fold 3/5
2026-01-28 04:56:28,771 - INFO -   Night-level metrics:
2026-01-28 04:56:28,772 - INFO -     Accuracy: 0.8010
2026-01-28 04:56:28,772 - INFO -     ROC-AUC: 0.9024
2026-01-28 04:56:28,773 - INFO -   Participant-level metrics:
2026-01-28 04:56:28,773 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:28,774 - INFO -     ROC-AUC: 0.9286
2026-01-28 04:56:28,775 - INFO -     Test participants: 17
2026-01-28 04:56:28,775 - INFO - 
Fold 4/5
2026-01-28 04:56:31,301 - INFO -   Night-level metrics:
2026-01-28 04:56:31,302 - INFO -     Accuracy: 0.8448
2026-01-28 04:56:31,303 - INFO -     ROC-AUC: 0.8963
2026-01-28 04:56:31,303 - INFO -   Participant-level metrics:
2026-01-28 04:56:31,304 - INFO -     Accuracy: 0.8750
2026-01-28 04:56:31,305 - INFO -     ROC-AUC: 0.9841
2026-01-28 04:56:31,305 - INFO -     Test participants: 16
2026-01-28 04:56:31,306 - INFO - 
Fold 5/5
2026-01-28 04:56:33,690 - INFO -   Night-level metrics:
2026-01-28 04:56:33,691 - INFO -     Accuracy: 0.7913
2026-01-28 04:56:33,691 - INFO -     ROC-AUC: 0.8689
2026-01-28 04:56:33,692 - INFO -   Participant-level metrics:
2026-01-28 04:56:33,692 - INFO -     Accuracy: 0.8235
2026-01-28 04:56:33,693 - INFO -     ROC-AUC: 0.9697
2026-01-28 04:56:33,693 - INFO -     Test participants: 17
2026-01-28 04:56:33,694 - INFO - 
SVM - Average Results:
2026-01-28 04:56:33,695 - INFO -   Night-level:
2026-01-28 04:56:33,697 - INFO -     Accuracy: 0.8087 ± 0.0186
2026-01-28 04:56:33,698 - INFO -     ROC-AUC: 0.9031 ± 0.0271
2026-01-28 04:56:33,699 - INFO -   Participant-level (CLINICAL PERFORMANCE):
2026-01-28 04:56:33,700 - INFO -     Accuracy: 0.8691 ± 0.0230
2026-01-28 04:56:33,700 - INFO -     Precision: 0.8314 ± 0.0396
2026-01-28 04:56:33,701 - INFO -     Recall: 0.9310 ± 0.0587
2026-01-28 04:56:33,702 - INFO -     F1: 0.8759 ± 0.0121
2026-01-28 04:56:33,703 - INFO -     ROC-AUC: 0.9598 ± 0.0321
2026-01-28 04:56:33,703 - INFO - 
======================================================================
2026-01-28 04:56:33,704 - INFO - Training XGBoost
2026-01-28 04:56:33,705 - INFO - ======================================================================
2026-01-28 04:56:33,707 - INFO - 
Fold 1/5
2026-01-28 04:56:47,842 - INFO -   Night-level metrics:
2026-01-28 04:56:47,843 - INFO -     Accuracy: 0.8096
2026-01-28 04:56:47,844 - INFO -     ROC-AUC: 0.9401
2026-01-28 04:56:47,844 - INFO -   Participant-level metrics:
2026-01-28 04:56:47,845 - INFO -     Accuracy: 0.8824
2026-01-28 04:56:47,845 - INFO -     ROC-AUC: 1.0000
2026-01-28 04:56:47,846 - INFO -     Test participants: 17
2026-01-28 04:56:47,847 - INFO - 
Fold 2/5
2026-01-28 04:57:00,841 - INFO -   Night-level metrics:
2026-01-28 04:57:00,842 - INFO -     Accuracy: 0.7845
2026-01-28 04:57:00,842 - INFO -     ROC-AUC: 0.8451
2026-01-28 04:57:00,843 - INFO -   Participant-level metrics:
2026-01-28 04:57:00,843 - INFO -     Accuracy: 0.8235
2026-01-28 04:57:00,844 - INFO -     ROC-AUC: 0.8611
2026-01-28 04:57:00,844 - INFO -     Test participants: 17
2026-01-28 04:57:00,845 - INFO - 
Fold 3/5
2026-01-28 04:57:14,401 - INFO -   Night-level metrics:
2026-01-28 04:57:14,402 - INFO -     Accuracy: 0.7888
2026-01-28 04:57:14,402 - INFO -     ROC-AUC: 0.9048
2026-01-28 04:57:14,403 - INFO -   Participant-level metrics:
2026-01-28 04:57:14,403 - INFO -     Accuracy: 0.8824
2026-01-28 04:57:14,404 - INFO -     ROC-AUC: 0.8571
2026-01-28 04:57:14,404 - INFO -     Test participants: 17
2026-01-28 04:57:14,405 - INFO - 
Fold 4/5
2026-01-28 04:57:28,416 - INFO -   Night-level metrics:
2026-01-28 04:57:28,416 - INFO -     Accuracy: 0.8448
2026-01-28 04:57:28,417 - INFO -     ROC-AUC: 0.9370
2026-01-28 04:57:28,417 - INFO -   Participant-level metrics:
2026-01-28 04:57:28,418 - INFO -     Accuracy: 0.8125
2026-01-28 04:57:28,418 - INFO -     ROC-AUC: 0.9683
2026-01-28 04:57:28,419 - INFO -     Test participants: 16
2026-01-28 04:57:28,419 - INFO - 
Fold 5/5
2026-01-28 04:57:41,478 - INFO -   Night-level metrics:
2026-01-28 04:57:41,479 - INFO -     Accuracy: 0.7840
2026-01-28 04:57:41,480 - INFO -     ROC-AUC: 0.8778
2026-01-28 04:57:41,480 - INFO -   Participant-level metrics:
2026-01-28 04:57:41,481 - INFO -     Accuracy: 0.8235
2026-01-28 04:57:41,481 - INFO -     ROC-AUC: 0.9394
2026-01-28 04:57:41,482 - INFO -     Test participants: 17
2026-01-28 04:57:41,483 - INFO - 
XGBoost - Average Results:
2026-01-28 04:57:41,484 - INFO -   Night-level:
2026-01-28 04:57:41,484 - INFO -     Accuracy: 0.8024 ± 0.0232
2026-01-28 04:57:41,485 - INFO -     ROC-AUC: 0.9010 ± 0.0361
2026-01-28 04:57:41,485 - INFO -   Participant-level (CLINICAL PERFORMANCE):
2026-01-28 04:57:41,486 - INFO -     Accuracy: 0.8449 ± 0.0309
2026-01-28 04:57:41,487 - INFO -     Precision: 0.8242 ± 0.0401
2026-01-28 04:57:41,488 - INFO -     Recall: 0.8838 ± 0.0723
2026-01-28 04:57:41,488 - INFO -     F1: 0.8498 ± 0.0222
2026-01-28 04:57:41,489 - INFO -     ROC-AUC: 0.9252 ± 0.0573
2026-01-28 04:57:41,510 - INFO - 
Results saved to: /work3/s184484/iRBD-detection/results/ml_baselines_v0/results_20260128_045741.json
2026-01-28 04:57:41,521 - INFO - Summary saved to: /work3/s184484/iRBD-detection/results/ml_baselines_v0/summary_20260128_045741.csv
2026-01-28 04:57:41,521 - INFO - 
Summary Table:
2026-01-28 04:57:41,530 - INFO - 
         Classifier  Night_Accuracy  Night_ROC_AUC  Participant_Accuracy  Participant_Precision  Participant_Recall  Participant_F1  Participant_ROC_AUC
      Random Forest        0.813056       0.910704              0.856618               0.839358            0.883802        0.857659             0.953860
Logistic Regression        0.791071       0.861399              0.881618               0.877857            0.881494        0.878759             0.930830
                SVM        0.808669       0.903070              0.869118               0.831429            0.931025        0.875897             0.959812
            XGBoost        0.802357       0.900977              0.844853               0.824206            0.883802        0.849753             0.925180
2026-01-28 04:57:41,536 - INFO - 
Random Forest feature importance saved to: /work3/s184484/iRBD-detection/results/ml_baselines_v0/feature_importance_rf.json
2026-01-28 04:57:41,537 - INFO - 
Top 10 Most Important Features (Random Forest):
2026-01-28 04:57:41,538 - INFO -   1. SSL_Feature_1: 0.027074 +/- 0.002276
2026-01-28 04:57:41,538 - INFO -   2. SSL_Feature_691: 0.026473 +/- 0.003930
2026-01-28 04:57:41,539 - INFO -   3. SSL_Feature_514: 0.021998 +/- 0.004374
2026-01-28 04:57:41,540 - INFO -   4. SSL_Feature_335: 0.018725 +/- 0.004172
2026-01-28 04:57:41,540 - INFO -   5. SSL_Feature_478: 0.017285 +/- 0.002088
2026-01-28 04:57:41,541 - INFO -   6. SSL_Feature_294: 0.017278 +/- 0.002499
2026-01-28 04:57:41,541 - INFO -   7. SSL_Feature_405: 0.014821 +/- 0.003605
2026-01-28 04:57:41,542 - INFO -   8. SSL_Feature_481: 0.014184 +/- 0.002862
2026-01-28 04:57:41,542 - INFO -   9. SSL_Feature_398: 0.012945 +/- 0.004249
2026-01-28 04:57:41,543 - INFO -   10. SSL_Feature_859: 0.012888 +/- 0.003795
2026-01-28 04:57:41,551 - INFO - 
XGBoost feature importance saved to: /work3/s184484/iRBD-detection/results/ml_baselines_v0/feature_importance_xgb.json
2026-01-28 04:57:41,552 - INFO - 
Top 10 Most Important Features (XGBoost):
2026-01-28 04:57:41,552 - INFO -   1. SSL_Feature_769: 0.045264 +/- 0.034522
2026-01-28 04:57:41,553 - INFO -   2. SSL_Feature_478: 0.038112 +/- 0.045936
2026-01-28 04:57:41,554 - INFO -   3. SSL_Feature_294: 0.030320 +/- 0.058001
2026-01-28 04:57:41,555 - INFO -   4. SSL_Feature_335: 0.013822 +/- 0.012033
2026-01-28 04:57:41,555 - INFO -   5. SSL_Feature_751: 0.013294 +/- 0.006967
2026-01-28 04:57:41,556 - INFO -   6. SSL_Feature_691: 0.011473 +/- 0.009107
2026-01-28 04:57:41,556 - INFO -   7. SSL_Feature_1: 0.010233 +/- 0.012894
2026-01-28 04:57:41,557 - INFO -   8. SSL_Feature_1007: 0.007171 +/- 0.006873
2026-01-28 04:57:41,558 - INFO -   9. SSL_Feature_257: 0.006507 +/- 0.004496
2026-01-28 04:57:41,558 - INFO -   10. SSL_Feature_115: 0.006003 +/- 0.007431
2026-01-28 04:57:41,560 - INFO - 
======================================================================
2026-01-28 04:57:41,561 - INFO - NIGHT-LEVEL CLASSIFICATION COMPLETED SUCCESSFULLY!
2026-01-28 04:57:41,561 - INFO - ======================================================================
